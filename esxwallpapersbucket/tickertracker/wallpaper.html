<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>TickerTracker</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
</head>

<body>
    <script>
        tickers = "AAPL,GOOGL,TSLA,AMZN,NVDA,FB,NFLX,TWTR,TWLO"

        for (let i = 0; i < tickers.split(",").length; i++) {
            let tickerDiv = document.createElement("div")
            tickerDiv.id = `ticker${i}`
            document.getElementsByTagName("body")[0].appendChild(tickerDiv)
        }

        postClientInfo()
        setInterval(() => {
            postClientInfo()
        }, 1000)

        getTickers()
        setInterval(() => {
            getTickers()
        }, 5 * 60 * 1000)

        function postClientInfo() {
            $.post("https://isyqwlkqej.execute-api.us-east-1.amazonaws.com/esx/clientinfo")
        }

        function getTickers() {
            $.get(`https://isyqwlkqej.execute-api.us-east-1.amazonaws.com/esx/tickers?tickers=${tickers}`, (tickerInfo) => {
                console.log(tickerInfo)
                for (let i = 0; i < tickerInfo.length; i++) {
                    $(`#ticker${i}`).text(JSON.stringify(tickerInfo[i]))
                }
            })
        }
    </script>
</body>

</html>